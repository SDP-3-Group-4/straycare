# Login & Sign-Up Screen Setup Guide

## Overview
The authentication screens are now created and ready for Firebase integration. This document outlines:
- Current screen structure
- Firebase integration steps
- File locations and organization

---

## File Structure

```
lib/
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ login_screen.dart          # Login screen with email/password & Google Sign-in
â”‚   â”‚   â””â”€â”€ signup_screen.dart         # Sign-up screen with email/password registration
â”‚   â”œâ”€â”€ home/
â”‚   â”œâ”€â”€ marketplace/
â”‚   â”œâ”€â”€ ai_bot/
â”‚   â”œâ”€â”€ notifications/
â”‚   â””â”€â”€ profile/
â””â”€â”€ main.dart                           # Updated to start with LoginScreen
```

---

## Current Features

### Login Screen (`login_screen.dart`)
- **Logo Placeholder**: Container with "SC" initials (ready for PNG replacement)
- **Google Sign-in Button**: With error handling for missing image assets
- **Email/Password Login**: With validation
- **Remember Me**: Checkbox for persistent login
- **Forgot Password**: Link placeholder for future implementation
- **Sign Up Link**: Navigates to sign-up screen

### Sign-Up Screen (`signup_screen.dart`)
- **Full Name Input**: With validation
- **Email Input**: With email format validation
- **Password & Confirm Password**: With visibility toggle
- **Terms & Conditions**: Checkbox requirement
- **Create Account Button**: With loading state
- **Login Link**: For existing users

---

## Firebase Integration Steps

### Step 1: Add Firebase Dependencies
Update `pubspec.yaml`:
```yaml
dependencies:
  flutter:
    sdk: flutter
  firebase_core: ^latest_version
  firebase_auth: ^latest_version
  google_sign_in: ^latest_version
```

Run: `flutter pub get`

### Step 2: Initialize Firebase
In `main.dart`, update the main function:
```dart
import 'package:firebase_core/firebase_core.dart';
import 'firebase_options.dart'; // Generated by Firebase CLI

void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  runApp(const StrayCareDemoApp());
}
```

### Step 3: Implement Email/Password Authentication

**In `login_screen.dart`, replace the `_handleLogin()` method:**
```dart
void _handleLogin() async {
  if (_formKey.currentState!.validate()) {
    setState(() {
      _isLoading = true;
    });

    try {
      final userCredential = await FirebaseAuth.instance.signInWithEmailAndPassword(
        email: _emailController.text.trim(),
        password: _passwordController.text,
      );
      
      // Navigate to home on successful login
      Navigator.of(context).pushReplacementNamed('/home');
      
    } on FirebaseAuthException catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text(e.message ?? 'Login failed')),
      );
    } finally {
      setState(() {
        _isLoading = false;
      });
    }
  }
}
```

### Step 4: Implement Google Sign-In

**In `login_screen.dart`, replace the `_handleGoogleLogin()` method:**
```dart
void _handleGoogleLogin() async {
  setState(() {
    _isLoading = true;
  });

  try {
    final GoogleSignInAccount? googleUser = await GoogleSignIn().signIn();
    
    if (googleUser != null) {
      final GoogleSignInAuthentication googleAuth = await googleUser.authentication;
      final credential = GoogleAuthProvider.credential(
        accessToken: googleAuth.accessToken,
        idToken: googleAuth.idToken,
      );
      
      await FirebaseAuth.instance.signInWithCredential(credential);
      Navigator.of(context).pushReplacementNamed('/home');
    }
  } on Exception catch (e) {
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('Google Sign-in failed: $e')),
    );
  } finally {
    setState(() {
      _isLoading = false;
    });
  }
}
```

### Step 5: Implement Sign-Up Registration

**In `signup_screen.dart`, replace the `_handleSignUp()` method:**
```dart
void _handleSignUp() async {
  if (_formKey.currentState!.validate()) {
    if (!_agreeToTerms) {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('Please agree to terms and conditions')),
      );
      return;
    }

    setState(() {
      _isLoading = true;
    });

    try {
      final userCredential = await FirebaseAuth.instance.createUserWithEmailAndPassword(
        email: _emailController.text.trim(),
        password: _passwordController.text,
      );
      
      // Update user profile with name
      await userCredential.user?.updateDisplayName(_nameController.text.trim());
      
      // Navigate to home on successful signup
      Navigator.of(context).pushReplacementNamed('/home');
      
    } on FirebaseAuthException catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text(e.message ?? 'Sign up failed')),
      );
    } finally {
      setState(() {
        _isLoading = false;
      });
    }
  }
}
```

### Step 6: Set Up Named Routes

**Update `main.dart` to add route management:**
```dart
MaterialApp(
  title: 'StrayCare Demo',
  theme: ThemeData(...),
  home: const LoginScreen(),
  routes: {
    '/login': (context) => const LoginScreen(),
    '/signup': (context) => const SignUpScreen(),
    '/home': (context) => const MainAppShell(),
  },
  debugShowCheckedModeBanner: false,
)
```

### Step 7: Add Navigation Between Auth Screens

**In `login_screen.dart`, update the Sign Up link:**
```dart
TextSpan(
  text: 'Sign Up',
  style: const TextStyle(...),
  recognizer: TapGestureRecognizer()
    ..onTap = () {
      Navigator.push(
        context,
        MaterialPageRoute(builder: (context) => const SignUpScreen()),
      );
    },
)
```

**In `signup_screen.dart`, update the Log In link:**
```dart
TextSpan(
  text: 'Log In',
  style: const TextStyle(...),
  recognizer: TapGestureRecognizer()
    ..onTap = () {
      Navigator.pop(context);
    },
)
```

### Step 8: Update Logo

Replace the "SC" placeholder with your PNG:

1. Add `assets/images/straycare_logo.png` to your assets folder
2. Update both screens:
```dart
Image.asset(
  'assets/images/straycare_logo.png',
  width: 100,
  height: 100,
)
```

---

## Environment Configuration

### Android Configuration
1. Update `android/build.gradle.kts` with Google services plugin
2. Add `google-services.json` from Firebase Console
3. Update `minSdkVersion` to 21 (Firebase requirement)

### iOS Configuration
1. Run `flutter pub get` (generates pod files automatically)
2. Add `GoogleService-Info.plist` from Firebase Console to Xcode
3. Update iOS deployment target to 11.0+

### Web Configuration
1. Update `web/index.html` with Firebase web SDK initialization
2. Add Firebase config from Firebase Console

---

## TODO Items Still Outstanding

- [ ] **Forgot Password Screen**: Password reset flow
- [ ] **Email Verification**: Verify user email after signup
- [ ] **Password Reset**: Email-based password recovery
- [ ] **Social Sign-In**: Additional providers (Facebook, Apple, etc.)
- [ ] **Two-Factor Authentication**: Enhanced security
- [ ] **Error Handling**: Comprehensive error messages
- [ ] **Biometric Authentication**: Fingerprint/Face ID support

---

## Testing

### Manual Testing
1. Test email/password login with valid credentials
2. Test with invalid email format
3. Test with weak passwords
4. Test Google Sign-in flow
5. Test Remember Me functionality
6. Test navigation between screens

### Firebase Testing
Use Firebase Emulator Suite for local testing:
```bash
firebase emulators:start
flutter run
```

---

## Security Best Practices

âœ… Already Implemented:
- Password field with visibility toggle
- Email validation regex
- Password length validation
- Loading states during authentication
- Error handling with user feedback

ðŸ“‹ Recommended Additions:
- Input sanitization
- Rate limiting on auth attempts
- Secure token storage
- Certificate pinning for Android
- Code obfuscation

---

## References

- [Firebase Flutter Documentation](https://firebase.google.com/docs/flutter/setup)
- [Google Sign-In Plugin](https://pub.dev/packages/google_sign_in)
- [Firebase Authentication](https://firebase.google.com/docs/auth)

---

## Support

For issues with Firebase setup, refer to:
- Firebase Console: https://console.firebase.google.com
- Flutter Firebase Documentation
- StackOverflow: Tag with `firebase`, `flutter`, `dart`
